{% extends "base.html" %}
{% load static %}

{% block title %}Home - InstrumentStore{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'products/css/product.css' %}">
{% endblock %}

{% block content %}
<!-- Start Hero Area -->
<section class="hero-area">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-12 custom-padding-right">
                <div class="slider-head">
                    <!-- Start Hero Slider -->
                    <div class="hero-slider">
                        {% for product in new_products %}
                        <!-- Start Single Slider -->
                        {% if product.image %}
<div class="single-slider" style="background-image: url('{{ product.image.url }}');">
{% else %}
<div class="single-slider" style="background-image: url('https://via.placeholder.com/800x500');">
{% endif %}

                            <div class="content">
                                <h2><span>New Arrival!</span>
                                    {{ product.name }}
                                </h2>
                                <p>{{ product.description|truncatewords:15|default:"High-quality musical instrument for professionals and enthusiasts" }}</p>
                                <h3><span>Now Only</span> {{ product.price|floatformat:0 }}₫</h3>
                                <div class="button">
                                    <a href="{% url 'products:product_detail' product.pk %}" class="btn">Shop Now</a>
                                </div>
                            </div>
                        </div>
                        <!-- End Single Slider -->
                        {% endfor %}
                    </div>
                    <!-- End Hero Slider -->
                </div>
            </div>
            <div class="col-lg-4 col-12">
                <div class="row">
                    <div class="col-lg-12 col-md-6 col-12 md-custom-padding">
                        <!-- Start Small Banner -->
                        <div class="hero-small-banner"
                            style="background-image: url('{{ new_products.2.image.url }}');">
                            <div class="content">
                                <h2>
                                    <span>Special Offer</span>
                                    {% if new_products.0 %}{{ new_products.0.name }}{% else %}Featured Product{% endif %}
                                </h2>
                                <h3>{% if new_products.0 %}{{ new_products.0.price|floatformat:0 }}₫{% else %}99.99₫{% endif %}</h3>
                            </div>
                        </div>
                        <!-- End Small Banner -->
                    </div>
                    <div class="col-lg-12 col-md-6 col-12">
                        <!-- Start Small Banner -->
                        <div class="hero-small-banner style2">
                            <div class="content">
                                <h2>Weekly Sale!</h2>
                                <p>Saving up to 50% off all online store items this week.</p>
                                <div class="button">
                                    <a class="btn" href="{% url 'products:product_list' %}">Shop Now</a>
                                </div>
                            </div>
                        </div>
                        <!-- Start Small Banner -->
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- End Hero Area -->

<!-- Start Featured Categories Area -->
<section class="featured-categories section">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <div class="section-title">
                    <h2>Featured Categories</h2>
                    <p>There are many variations of passages of Lorem Ipsum available, but the majority have
                        suffered alteration in some form.</p>
                </div>
            </div>
        </div>
        <div class="row">
{% for category in feature_categories %}
<div class="col-lg-4 col-md-6 col-12">
    <div class="single-category">
        <h3 class="heading">{{ category.name }}</h3>

        <ul>
            <li><a href="product-grids.html">Double Bass</a></li>
            <li><a href="product-grids.html">Oboe</a></li>
            <li><a href="product-grids.html">Cajon</a></li>
            <li><a href="product-grids.html">Keyboard</a></li>
            <li>
                <a href="{% url 'products:product_list' %}?category={{ category.id }}">
                    View All
                </a>
            </li>
        </ul>

        <div class="images">
            <img src="{% static 'images/feature-categories/' %}{{ category.name|lower }}.jpg"
     alt="{{ category.name }}">
        </div>
    </div>
</div>
{% endfor %}


            <div class="col-lg-4 col-md-6 col-12">
                <!-- Start Single Category -->
                <div class="single-category">
                    <h3 class="heading">Accessories</h3>
                    <ul>
                        <li><a href="product-grids.html">Double Bass</a></li>
                        <li><a href="product-grids.html">Oboe</a></li>
                        <li><a href="product-grids.html">Cajon</a></li>
                        <li><a href="product-grids.html">Keyboard</a></li>
                        <li><a href="product-grids.html">View All</a></li>
                    </ul>
                    <div class="images">
                        <img src="{% static 'images/feature-categories/accessories.jpg' %}" alt="#">
                    </div>
                </div>
                <!-- End Single Category -->
            </div>
           
           
        </div>
    </div>
</section>
<!-- End Features Area -->

<!-- Start Flash Sale Area -->
<section class="flash-sale-section"></section>
    <div class="container">
        <!-- Header -->
        <div class="flash-header">
            <h2 class="flash-title">
                <span class="icon">⚡</span>
                <span>FLASH SALE</span>
                {% if flash_sale_end %}
                <div class="flash-countdown" data-end="{{ flash_sale_end|date:'U' }}">
                    <div class="time-box hours">00</div>
                    <div class="time-box minutes">00</div>
                    <div class="time-box seconds">00</div>
                </div>
                {% endif %}
            </h2>
            <a href="#" class="view-all-link">
                Xem tất cả ›
            </a>
        </div>

        <!-- Product Grid -->
        <div class="flash-slider">
            {% for sale in flash_sales %}
            <a href="{% url 'products:product_detail' sale.product.pk %}" class="flash-product-card">
                
                <span class="discount-badge">-{{ sale.discount_percent }}%</span>
                
                <div class="product-image-container">
                    <img src="{{ sale.product.image.url }}" 
                         alt="{{ sale.product.name }}"
                         loading="lazy">
                </div>
                
                <div class="product-details">
                    <h4 class="product-title">{{ sale.product.name|upper }}</h4>
                    
                    <div class="price-container">
                        <span class="current-price">
                            {{ sale.flash_price|floatformat:0 }} ₫
                        </span>
                        {% if sale.product.original_price %}
                        <span class="old-price">
                            {{ sale.product.original_price|floatformat:0 }} ₫
                        </span>
                        {% endif %}
                    </div>
                    
                    <div class="stock-status">
                        {% if sale.quantity <= 10 %}
                        <div class="status-badge limited">
                            CHỈ CÒN {{ sale.quantity }}
                        </div>
                        {% else %}
                        <div class="status-badge">
                            ĐANG BÁN CHẠY
                        </div>
                        {% endif %}
                    </div>
                    
                </div>
            </a>
            {% empty %}
            <div class="empty-flash-sale" style="grid-column: 1 / -1;">
                <p>Hiện chưa có flash sale nào đang diễn ra</p>
            </div>
            {% endfor %}
        </div>
    </div>
</section>

<!-- End Flash Sale Area -->

<!-- Start Trending Product Area -->
<section class="trending-product section" style="margin-top: 12px;">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <div class="section-title">
                    <h2>Trending Product</h2>
                    <p>There are many variations of passages of Lorem Ipsum available, but the majority have
                        suffered alteration in some form.</p>
                </div>
            </div>
        </div>
        <div class="row">
            {% for product in trending_products %}
            <div class="col-lg-3 col-md-6 col-12">
                <!-- Start Single Product -->
                <div class="single-product">
                    <div class="product-image">
                        <img src="{% if product.image %}{{ product.image.url }}{% else %}https://via.placeholder.com/300x300{% endif %}" alt="{{ product.name }}">
                        {% if product.discount_percent > 0 %}
                        <span class="sale-tag">-{{ product.discount_percent }}%</span>
                        {% elif product.is_new %}
                        <span class="new-tag">New</span>
                        {% endif %}
                                                        
                        <div class="button">
                            <a href="{% url 'products:product_detail' product.pk %}" class="btn"><i class="lni lni-cart"></i> Add to Cart</a>
                        </div>
                    </div>
                    <div class="product-info">
                        <span class="category">{{ product.category.name }}</span>
                        <h4 class="title">
                            <a href="{% url 'products:product_detail' product.pk %}">{{ product.name }}</a>
                        </h4>
                        <ul class="review">
                            {% for i in "12345"|make_list %}
                                {% if forloop.counter <= product.avg_rating|default:0 %}
                                <li><i class="lni lni-star-filled"></i></li>
                                {% else %}
                                <li><i class="lni lni-star"></i></li>
                                {% endif %}
                            {% endfor %}
                            <li><span>{{ product.reviews.count|default:0 }} Review(s)</span></li>
                        </ul>
                        <div class="price">
                            <span>{{ product.price|floatformat:0 }}₫</span>
                            {% if product.discount_percent > 0 %}
                              <span class="discount-price">
                              {{ product.original_price|floatformat:0 }}₫
                              </span>
                               {% endif %}
                        </div>
                    </div>
                </div>
                <!-- End Single Product -->
            </div>
            {% empty %}
            <div class="col-12">
                <p class="text-center">No products available.</p>
            </div>
            {% endfor %}
        </div>
    </div>
</section>
<!-- End Trending Product Area -->



<!-- Start Banner Area -->
<section class="banner section">
    <div class="container">
        <div class="row">
            <div class="col-lg-6 col-md-6 col-12">
                <div class="single-banner" style="background-image:url('{% static 'images/banner/banner1.jpg' %}')">
                    <div class="content">
                        <h2>Start Your Music Journey</h2>
                        <p>Easy to play <br>Affordable instruments </p>
                        <div class="button">
                            <a href="{% url 'products:product_list' %}" class="btn">View Details</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-6 col-md-6 col-12">
                <div class="single-banner custom-responsive-margin"
                    style="background-image:url('{% static 'images/banner/banner2.jpg' %}')">
                    <div class="content">
                        <h2>Play Like a Professional</h2>
                        <p>Premium Sound – Elevate Your Listening <br>Built to last.</p>
                        <div class="button">
                            <a href="{% url 'products:product_list' %}" class="btn">Shop Now</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- End Banner Area -->

<!-- Start Special Offer -->
<section class="special-offer section">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <div class="section-title">
                    <h2>Special Selection</h2>
                    <p>Carefully selected instruments just for you passages of Lorem Ipsum available, but the majority have
                        suffered alteration in some form.</p>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-8 col-md-12 col-12">
                <div class="row">
                    {% for product in random_products|slice:":3" %}
                    <div class="col-lg-4 col-md-4 col-12">
                        <!-- Start Single Product -->
                        
                        <div class="single-product">
                            <div class="product-image">
                                <img src="{% if product.image %}{{ product.image.url }}{% else %}https://via.placeholder.com/300x300{% endif %}" alt="{{ product.name }}">
                                {% if product.discount_percent > 0 %}
                        <span class="sale-tag">-{{ product.discount_percent }}%</span>
                        {% elif product.is_new %}
                        <span class="new-tag">New</span>
                        {% endif %}
                                <div class="button">
                                    <a href="{% url 'products:product_detail' product.pk %}" class="btn"><i class="lni lni-cart"></i> Add to
                                        Cart</a>
                                </div>
                            </div>
                            <div class="product-info">
                                <span class="category">{{ product.category.name }}</span>
                                <h4 class="title">
                                    <a href="{% url 'products:product_detail' product.pk %}">{{ product.name }}</a>
                                </h4>
                                <ul class="review">
                                    {% for i in "12345"|make_list %}
                                        {% if forloop.counter <= product.avg_rating|default:0 %}
                                        <li><i class="lni lni-star-filled"></i></li>
                                        {% else %}
                                        <li><i class="lni lni-star"></i></li>
                                        {% endif %}
                                    {% endfor %}
                                    <li><span>{{ product.reviews.count|default:0 }} Review(s)</span></li>
                                </ul>
                                <div class="price">
                                    <span>{{ product.price|floatformat:0 }}₫</span>
                            {% if product.discount_percent > 0 %}
                              <span class="discount-price">
                              {{ product.original_price|floatformat:0 }}₫
                              </span>
                               {% endif %}
                                </div>
                            </div>
                        </div>
                        <!-- End Single Product -->
                    </div>
                    {% endfor %}
                </div>
                <!-- Start Banner -->
                {% for product in random_products|slice:"3:4" %}
                <div class="single-banner right" style="background-image:url('{% static 'images/banner/banner3.png' %}');margin-top: 30px;">
                    <div class="content">
                        <h2>{{ product.name }} </h2>
                        <p>Lorem ipsum dolor sit amet, <br>eiusmod tempor
                            incididunt ut labore.</p>
                        <div class="price">
                            <span>{{ product.price|floatformat:0 }}₫</span>
                        </div>
                        <div class="button">
                            <a href="{% url 'products:product_list' %}" class="btn">Shop Now</a>
                        </div>
                    </div>
                </div>
                {% endfor %}
                <!-- End Banner -->
            </div>
            <div class="col-lg-4 col-md-12 col-12">
                <div class="offer-content">
                    {% for product in random_products|slice:"4:5" %}
                    <div class="image">
                        <img src="{% if product.image %}{{ product.image.url }}{% else %}https://via.placeholder.com/300x300{% endif %}" alt="{{ product.name }}">
                        {% if product.discount_percent > 0 %}
                        <span class="sale-tag">-{{ product.discount_percent }}%</span>
                        {% elif product.is_new %}
                        <span class="new-tag">New</span>
                        {% endif %}
                    </div>
                    <div class="text">
                        <h2><a href="{% url 'products:product_detail' product.pk %}">{{ product.name }}</a></h2>
                        <ul class="review">
                            {% for i in "12345"|make_list %}
                                {% if forloop.counter <= product.avg_rating|default:0 %}
                                <li><i class="lni lni-star-filled"></i></li>
                                {% else %}
                                <li><i class="lni lni-star"></i></li>
                                {% endif %}
                            {% endfor %}
                            <li><span>{{ product.reviews.count|default:0 }} Review(s)</span></li>
                        </ul>
                        <div class="price">
                            <span>{{ product.price|floatformat:0 }}₫</span>
                            {% if product.discount_percent > 0 %}
                              <span class="discount-price">
                              {{ product.original_price|floatformat:0 }}₫
                              </span>
                               {% endif %}
                            
                        </div>
                        <p>{{ product.description }}</p>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
</section>
<!-- End Special Offer -->

<!-- Start Home Product List -->
<section class="home-product-list section">
    <div class="container">
        <div class="row">
            <div class="col-lg-4 col-md-4 col-12 custom-responsive-margin">
                <h4 class="list-title">Best Sellers</h4>
                <!-- Start Single List -->
                {% for product in random_products|slice:"5:8" %}
                <div class="single-list">
                    <div class="list-image">
                        <a href="{% url 'products:product_detail' product.pk %}"><img src="{% if product.image %}{{ product.image.url }}{% else %}https://via.placeholder.com/300x300{% endif %}" alt="{{ product.name }}"></a>
                    </div>
                    <div class="list-info">
                        <h3>
                            <a href="{% url 'products:product_detail' product.pk %}">{{ product.name }}</a>
                        </h3>
                        <span>{{ product.price|floatformat:0 }}₫</span>
                    </div>
                </div>
                {% endfor %}
                <!-- End Single List -->
             
            </div>
            <div class="col-lg-4 col-md-4 col-12 custom-responsive-margin">
                <h4 class="list-title">New Arrivals</h4>
                <!-- Start Single List -->
                {% for product in random_products|slice:"8:11" %}
                <div class="single-list">
                    <div class="list-image">
                        <a href="{% url 'products:product_detail' product.pk %}"><img src="{% if product.image %}{{ product.image.url }}{% else %}https://via.placeholder.com/300x300{% endif %}" alt="{{ product.name }}"></a>
                    </div>
                    <div class="list-info">
                        <h3>
                            <a href="{% url 'products:product_detail' product.pk %}">{{ product.name }}</a>
                        </h3>
                        <span>{{ product.price|floatformat:0 }}₫</span>
                    </div>
                </div>
                {% endfor %}
                <!-- End Single List -->
            </div>
            <div class="col-lg-4 col-md-4 col-12">
                <h4 class="list-title">Top Rated</h4>
                <!-- Start Single List -->
                {% for product in random_products|slice:"11:14" %}
                <div class="single-list">
                    <div class="list-image">
                        <a href="{% url 'products:product_detail' product.pk %}"><img src="{% if product.image %}{{ product.image.url }}{% else %}https://via.placeholder.com/300x300{% endif %}" alt="{{ product.name }}"></a>
                    </div>
                    <div class="list-info">
                        <h3>
                            <a href="{% url 'products:product_detail' product.pk %}">{{ product.name }}</a>
                        </h3>
                        <span>{{ product.price|floatformat:0 }}₫</span>
                    </div>
                </div>
                {% endfor %}
                <!-- End Single List -->
            </div>
        </div>
    </div>
</section>
<!-- End Home Product List -->

<!-- Start Brands Area -->
<div class="brands">
    <div class="container">
        <div class="row">
            <div class="col-lg-6 offset-lg-3 col-md-12 col-12">
                <h2 class="title">Popular Brands</h2>
            </div>
        </div>
<div class="brands-logo-wrapper">
    <div class="brands-logo-carousel d-flex align-items-center justify-content-between">
        
        <div class="brand-logo">
            <img src="{% static 'images/brands/01_Fender.png' %}" alt="Fender">
        </div>

        <div class="brand-logo">
            <img src="{% static 'images/brands/02_Gibson.png' %}" alt="Gibson">
        </div>

        <div class="brand-logo">
            <img src="{% static 'images/brands/03_Ibanez.png' %}" alt="Ibanez">
        </div>

        <div class="brand-logo">
            <img src="{% static 'images/brands/04_Squier.png' %}" alt="Squier">
        </div>

        <div class="brand-logo">
            <img src="{% static 'images/brands/05_Epiphone.png' %}" alt="Epiphone">
        </div>

        <div class="brand-logo">
            <img src="{% static 'images/brands/06_Yamaha.png' %}" alt="Yamaha">
        </div>

        <div class="brand-logo">
            <img src="{% static 'images/brands/07_Martin.png' %}" alt="Martin">
        </div>

        <div class="brand-logo">
            <img src="{% static 'images/brands/08_Taylor.png' %}" alt="Taylor">
        </div>

        <div class="brand-logo">
            <img src="{% static 'images/brands/09_Marshall.png' %}" alt="Marshall">
        </div>

        <div class="brand-logo">
            <img src="{% static 'images/brands/10_Korg.png' %}" alt="Korg">
        </div>

        <div class="brand-logo">
            <img src="{% static 'images/brands/11_Akai.png' %}" alt="Akai">
        </div>

        <div class="brand-logo">
            <img src="{% static 'images/brands/12_Roland.png' %}" alt="Roland">
        </div>

        <div class="brand-logo">
            <img src="{% static 'images/brands/13_Tascam.png' %}" alt="Tascam">
        </div>

        <div class="brand-logo">
            <img src="{% static 'images/brands/14_Shure.png' %}" alt="Shure">
        </div>

        <div class="brand-logo">
            <img src="{% static 'images/brands/15_Ernie_Ball.png' %}" alt="Ernie Ball">
        </div>

        <div class="brand-logo">
            <img src="{% static 'images/brands/16_Vox.png' %}" alt="Vox">
        </div>

        <div class="brand-logo">
            <img src="{% static 'images/brands/17_Behringer.png' %}" alt="Behringer">
        </div>

        <div class="brand-logo">
            <img src="{% static 'images/brands/18_Peavey.png' %}" alt="Peavey">
        </div>

        <div class="brand-logo">
            <img src="{% static 'images/brands/19_AKG.png' %}" alt="AKG">
        </div>

        <div class="brand-logo">
            <img src="{% static 'images/brands/20_Hohner.png' %}" alt="Hohner">
        </div>

        <div class="brand-logo">
            <img src="{% static 'images/brands/21_Lee_Oskar.png' %}" alt="Lee Oskar">
        </div>

    </div>
</div>

    </div>
</div>
<!-- End Brands Area -->

<!-- Start Shipping Info -->
<section class="shipping-info">
    <div class="container">
        <ul>
            <!-- Free Shipping -->
            <li>
                <div class="media-icon">
                    <i class="lni lni-delivery"></i>
                </div>
                <div class="media-body">
                    <h5>Free Shipping</h5>
                    <span>On order over 99000₫</span>
                </div>
            </li>
            <!-- Money Return -->
            <li>
                <div class="media-icon">
                    <i class="lni lni-support"></i>
                </div>
                <div class="media-body">
                    <h5>24/7 Support.</h5>
                    <span>Live Chat Or Call.</span>
                </div>
            </li>
            <!-- Support 24/7 -->
            <li>
                <div class="media-icon">
                    <i class="lni lni-credit-cards"></i>
                </div>
                <div class="media-body">
                    <h5>Online Payment.</h5>
                    <span>Secure Payment Services.</span>
                </div>
            </li>
            <!-- Safe Payment -->
            <li>
                <div class="media-icon">
                    <i class="lni lni-reload"></i>
                </div>
                <div class="media-body">
                    <h5>Easy Return.</h5>
                    <span>Hassle Free Shopping.</span>
                </div>
            </li>
        </ul>
    </div>
</section>
<!-- End Shipping Info -->
{% endblock %}

{% block extra_js %}
<script type="text/javascript">
    //========= Hero Slider 
    tns({
        container: '.hero-slider',
        slideBy: 'page',
        autoplay: true,
        autoplayButtonOutput: false,
        mouseDrag: true,
        gutter: 0,
        items: 1,
        nav: false,
        controls: true,
        controlsText: ['<i class="lni lni-chevron-left"></i>', '<i class="lni lni-chevron-right"></i>'],
    });

     //======== Brand Slider
     tns({
            container: '.brands-logo-carousel',
            autoplay: true,
            autoplayButtonOutput: false,
            mouseDrag: true,
            gutter: 15,
            nav: false,
            controls: false,
            responsive: {
                0: {
                    items: 1,
                },
                540: {
                    items: 3,
                },
                768: {
                    items: 5,
                },
                992: {
                    items: 6,
                }
            }
        });


    /* Flash Sale Slider */
tns({
    container: '.flash-slider',
    items: 4,          // Hiển thị 4 sản phẩm
    slideBy: 3,        //  Trượt mỗi lần 3 sản phẩm
    autoplay: false,
    mouseDrag: true,
    gutter: 15,
    nav: false,
    controls: true,
    controlsText: [
        '<i class="lni lni-chevron-left"></i>',
        '<i class="lni lni-chevron-right"></i>'
    ],
    responsive: {
        0: {
            items: 1,
            slideBy: 1
        },
        576: {
            items: 2,
            slideBy: 2
        },
        992: {
            items: 4,
            slideBy: 3
        }
    }
});

/* Flash Sale Countdown */
document.addEventListener("DOMContentLoaded", function () {
  const el = document.querySelector(".flash-countdown");
  if (!el) return;

  const end = parseInt(el.dataset.end) * 1000;

  const tick = () => {
    const diff = end - Date.now();

    if (diff <= 0) {
      el.innerText = "⏰ Đã kết thúc";
      return;
    }

    const h = String(Math.floor(diff / 3600000)).padStart(2, '0');
    const m = String(Math.floor(diff % 3600000 / 60000)).padStart(2, '0');
    const s = String(Math.floor(diff % 60000 / 1000)).padStart(2, '0');

    el.querySelector('.hours').textContent = h;
    el.querySelector('.minutes').textContent = m;
    el.querySelector('.seconds').textContent = s;
  };

  tick();
  setInterval(tick, 1000);
});



</script>
    
{% endblock %}